<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>About Developers</title>
    <link rel="stylesheet" href="/CSS/navigation.css" />
    <link rel="stylesheet" href="/CSS/about-developers-styles.css">
</head>

<body>
    <header class="navbar">
        <img src="/IMAGES/logo_2.png" alt="logo_2" class="logo_2">
        <nav class="nav-links">
            <a href="/pet-products" id="pet-products">Pet Products</a>
            <a href="/adopt" id="adopt">Adopt a Pet</a>
            <a href="/about-developers" id="about-developers">Contact Us</a>
            <a href="/login" id="login">Login</a>
        </nav>
    </header>

    <!-- Developers Info -->
    <main>
        <!-- We can use the adopt the pet's card instead here
         we will have to write more info as well -->
        <section class="about-developers">
            <h2>Meet the Developers</h2>
            <div class="dev-info">

                <!--Developer: Aysha-->
                <div class="dev-card">
                    <h3>Aysha</h3>
                    <p>Hello! Iâ€™m Aysha Hira, currently pursuing my degree in Computer Science. Iâ€™m passionate about web
                        development, especially the creativity and structure behind building intuitive and functional
                        user interfaces. Over the past semester, Iâ€™ve developed growing interest and experience in
                        full-stack technologies, especially using JavaScript, Node.js, and MongoDB.</p>

                    <strong>ðŸ“Œ Talents & Skills:</strong>
                    <ul>
                        <li>Skilled in HTML5, CSS, and JavaScript</li>
                        <li>experience with Node.js, Express.js and MongoDB</li>
                        <li>Rapid problem-solving and debugging</li>
                        <li>Eye for UI/UX and usability</li>
                    </ul>

                    <strong>ðŸŽ® Interests:</strong>
                    <ul>
                        <li>Web development and exploring AI tools</li>
                        <li>Gaming during downtime</li>
                        <li>learning through hands-on projects</li>
                        <li>Creating minimalist, user-friendly interfaces</li>
                    </ul>
                </div>

                <!--Developer: Mehejat-->
                <div class="dev-card">

                    <h3>Mehejat</h3>
                    <p>Hello! Iâ€™m Mahejat, a frontend developer who loves bringing designs to life using HTML and CSS. I
                        enjoy turning ideas into elegant, responsive layouts that work beautifully on all screen sizes.
                        Iâ€™m especially drawn to the creative freedom of frontend design and building interfaces that
                        users find easy and enjoyable to use.</p>

                    <strong>ðŸ“Œ Talents & Skills:</strong>
                    <ul>
                        <li>Interest in HTML5, CSS and JavaScript</li>
                        <li>Responsive design & layout structuring</li>
                        <li>Modern UI/UX design principles</li>
                        <li>Version control with Git and GitHub</li>

                    </ul>

                    <strong>ðŸŽ¯ Interests:</strong>

                    <ul>
                        <li>Exploring CSS animations and transitions</li>
                        <li>Designing user-friendly page layouts</li>
                        <li>learning new UI trends and tools</li>
                        <li>Exploring full-stack development (Mongoose)</li>
                    </ul>
                </div>


            </div>
        </section>

        <!-- Contact Section -->
        <section class="contact">
            <h1>Contact Us</h1>
            <p>
                Got a question or need a paw-some tip? Whether you have a curious cat or a playful pup,
                weâ€™re here to help! Reach out â€” we love hearing from fellow pet lovers.
            </p>

            <!-- Contact Form -->
            <div class="contact-section">
                <!-- method="post" action="/submit-contact-us-form" -->
                <form class="contact-form" id="form">
                    <label for="name">Name <input type="text" id="name" placeholder="Enter your name" name="name"
                            required /></label>

                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email" name="email" required />

                    <label for="message">Message</label>
                    <textarea id="message" rows="4" placeholder="Write your message here" name="message"
                        required></textarea>

                    <button type="submit" onclick="send()">Send Now</button>
                </form>
            </div>

            <div class="contact-info-row">
                <div class="info-box">
                    <h3>Phone</h3>
                    <p>(+971)-504259539</p>
                </div>
                <div class="info-box">
                    <h3>WhatsApp</h3>
                    <p>(+971)-564127840</p>
                </div>
                <div class="info-box">
                    <h3>Email</h3>
                    <p>thebarkinglot221@gmail.com</p>
                </div>
                <div class="info-box">
                    <h3>Our Shop</h3>
                    <p>Al Wasl Road, Al Thanya St,<br />Umm Suqeim, Dubai, UAE</p>
                </div>
            </div>
        </section>

        <div id="popup"
            style="display: none; position: fixed; top: 20px; right: 20px; background: #28a745; color: white; padding: 15px 25px; border-radius: 8px; z-index: 1000;">
            âœ… Message sent successfully!
        </div>

    </main>

    <script>
        const url = window.location.pathname;
        const pathParts = url.split('/');

        if (pathParts.length > 2) {
            userName = pathParts[pathParts.length - 1];
            document.getElementById('pet-products').href += `/${userName}`;
            document.getElementById('adopt').href += `/${userName}`;
            document.getElementById('about-developers').href += `/${userName}`;
            document.getElementById('login').removeAttribute('href'); // removes the link after signing in
            document.getElementById('login').innerHTML = 'Profile';

            fetch(`/profile/${userName}`)
                .then(res => res.json())
                .then(data => {
                    const user = data.user[0];
                    console.log(user);
                    document.getElementById('full_name').value = user.full_name
                    document.getElementById('email').value = user.email;
                    if (user.address)
                        document.getElementById('address').value = user.address;

                    if (user.contact_number)
                        document.getElementById('contact_number').value = user.contact_number;

                    if (user.occupation)
                        document.getElementById('occupation').value = user.occupation;

                }).catch(error => console.log(error));

            // to view the profile
            document.getElementById('login').addEventListener('click', () => {
                count++;
                const profile = document.getElementById('profile');
                profile.style.display = "flex";

                // for closing the profile by clicking on the profile
                if (count > 1) {
                    count = 0;
                    profile.style.display = "none";

                }
            });

            // shows the adoption forms
            const submittedForms = document.getElementById('forms-submitted');

            fetch(`/get-forms/${userName}`)
                .then(res => {
                    if (!res.ok) throw new Error("Failed to fetch forms");
                    return res.json();
                })
                .then(data => {
                    if (!Array.isArray(data) || data.length === 0) {
                        submittedForms.innerHTML += `<p>No adoption forms submitted.</p>`;
                        return;
                    }

                    const ul = document.createElement('ul');
                    data.forEach(form => {
                        const li = document.createElement('li');
                        li.textContent = `${form.pet_name} submitted`;
                        ul.appendChild(li);
                    });

                    submittedForms.appendChild(ul);
                })
                .catch(error => {
                    console.error("Error fetching forms:", error);
                    submittedForms.innerHTML += `<p style="color: red;">Unable to load forms.</p>`;
                });


            var address = document.getElementById('address');
            var contact_number = document.getElementById('contact_number');
            var occupation = document.getElementById('occupation');

            const editBtn = document.getElementById('edit');
            var editCount = 0;

            editBtn.addEventListener("click", async () => {
                editCount++;
                editBtn.textContent = "save"

                address.disabled = false;
                contact_number.disabled = false;
                occupation.disabled = false;

                if (editCount > 1) {
                    editBtn.textContent = "Edit"
                    editCount = 0;

                    address.disabled = true;
                    contact_number.disabled = true;
                    occupation.disabled = true;

                    const updateData = {
                        full_name: userName,
                        address: address.value,
                        contact_number: contact_number.value,
                        occupation: occupation.value
                    };


                    try {
                        const res = await fetch("/update-profile", {
                            method: "PUT",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify(updateData)
                        });

                        const result = await res.json();

                        if (res.ok) {
                            alert("Profile updated successfully!");
                        } else {
                            alert("Update failed: " + result.message);
                        }
                    } catch (err) {
                        console.error("Update error:", err);
                        alert("Something went wrong.");
                    }

                }

            });


        }

        document.getElementById("form")
            .addEventListener("submit", async function (e) {
                e.preventDefault(); // Prevent page reload

                const formData = new FormData(this);
                const body = Object.fromEntries(formData.entries());

                const res = await fetch("/submit-contact-us-form", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(body)
                });

                document.getElementById("popup").style.display = "block"; // makes the message visible
                document.getElementById('form').reset(); // resets the form

                if (res.ok)
                    setTimeout(() => {
                        document.getElementById("popup").style.display = "none";
                    }, 3000);

                else
                    setTimeout(() => {
                        document.getElementById("popup").style.display = "none";
                        document.getElementById("popup").style.color = "red";
                    }, 3000);
            });
    </script>

</body>

</html>